[2017-01-22 14:09:22,176] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:09:22,177] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:09:22,177] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:09:22,178] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:09:22,178] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:09:22,180] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:09:22,180] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:09:22,180] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:09:22,181] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:09:22,184] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:09:22,185] INFO [Controller 0]: Initialized controller epoch to 18 and zk version 17 (kafka.controller.KafkaController)
[2017-01-22 14:09:22,185] INFO [Controller 0]: Controller 0 incremented epoch to 19 (kafka.controller.KafkaController)
[2017-01-22 14:09:22,185] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:09:22,191] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:09:22,192] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:09:22,192] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:09:22,192] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:09:22,192] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:09:22,197] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:09:22,198] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:09:22,198] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 19 (kafka.controller.KafkaController)
[2017-01-22 14:09:22,198] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:09:22,198] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:09:22,199] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:09:24,410] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:09:24,410] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:09:24,413] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:09:24,413] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:09:24,414] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:09:24,414] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:09:24,414] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:09:24,414] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:09:24,417] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:09:24,417] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":16,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:09:24,418] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:09:24,421] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:09:24,421] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:09:24,424] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:09:24,426] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:09:24,428] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:09:27,204] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:09:27,204] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:09:27,204] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:09:27,204] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:11:26,730] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:11:26,730] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:11:26,730] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:11:26,731] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:11:26,731] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:11:26,733] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:11:26,733] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:11:26,733] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:11:26,733] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:11:26,739] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:11:26,740] INFO [Controller 0]: Initialized controller epoch to 19 and zk version 18 (kafka.controller.KafkaController)
[2017-01-22 14:11:26,741] INFO [Controller 0]: Controller 0 incremented epoch to 20 (kafka.controller.KafkaController)
[2017-01-22 14:11:26,747] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:11:26,764] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:11:26,765] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:11:26,765] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:11:26,765] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:11:26,765] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:11:26,765] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:11:26,766] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:11:26,771] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:11:26,772] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:11:26,773] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 20 (kafka.controller.KafkaController)
[2017-01-22 14:11:26,773] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:11:26,773] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:11:26,774] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:11:28,541] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:11:28,541] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:11:28,544] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:11:28,544] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:11:28,544] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:11:28,545] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:11:28,545] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:11:28,545] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:11:28,548] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:11:28,548] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":17,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:11:28,549] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:11:28,551] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:11:28,551] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:11:28,555] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:11:28,557] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:11:28,559] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:11:31,781] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:11:31,782] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:11:31,782] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:11:31,782] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:12:28,290] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:12:28,290] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:12:28,291] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:12:28,291] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:12:28,291] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:12:28,294] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:12:28,294] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:12:28,294] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:12:28,294] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:12:28,298] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:12:28,298] INFO [Controller 0]: Initialized controller epoch to 20 and zk version 19 (kafka.controller.KafkaController)
[2017-01-22 14:12:28,299] INFO [Controller 0]: Controller 0 incremented epoch to 21 (kafka.controller.KafkaController)
[2017-01-22 14:12:28,299] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:12:28,308] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:12:28,308] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:12:28,308] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:12:28,309] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:12:28,309] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:12:28,309] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:12:28,310] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:12:28,310] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:12:28,310] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:12:28,310] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:12:28,310] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:12:28,311] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:12:28,315] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:12:28,315] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:12:28,316] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 21 (kafka.controller.KafkaController)
[2017-01-22 14:12:28,316] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:12:28,316] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:12:28,316] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:12:30,556] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:12:30,557] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:12:30,559] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:12:30,559] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:12:30,559] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:12:30,560] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:12:30,560] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:12:30,560] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:12:30,564] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:12:30,564] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":18,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:12:30,565] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:12:30,567] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:12:30,567] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:12:30,570] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:12:30,572] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:12:30,574] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:12:33,327] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:12:33,327] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:12:33,327] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:12:33,327] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:13:30,515] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:13:30,515] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:13:30,515] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:13:30,516] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:13:30,516] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:13:30,517] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:13:30,518] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:13:30,518] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:13:30,518] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:13:30,520] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:13:30,521] INFO [Controller 0]: Initialized controller epoch to 21 and zk version 20 (kafka.controller.KafkaController)
[2017-01-22 14:13:30,521] INFO [Controller 0]: Controller 0 incremented epoch to 22 (kafka.controller.KafkaController)
[2017-01-22 14:13:30,522] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:13:30,527] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:13:30,528] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:13:30,548] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:13:30,549] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:13:30,550] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 22 (kafka.controller.KafkaController)
[2017-01-22 14:13:30,550] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:13:30,550] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:13:30,552] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:13:32,635] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:13:32,636] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:13:32,639] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:13:32,639] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:13:32,639] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:13:32,640] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:13:32,640] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:13:32,641] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:13:32,644] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:13:32,644] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":19,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:13:32,645] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:13:32,647] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:13:32,647] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:13:32,651] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:13:32,653] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:13:32,655] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:13:35,557] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:13:35,557] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:13:35,557] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:13:35,557] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:16:38,174] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:16:38,174] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:16:38,174] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:16:38,174] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:16:38,174] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:16:38,176] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:16:38,176] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:16:38,176] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:16:38,177] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:16:38,181] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:16:38,181] INFO [Controller 0]: Initialized controller epoch to 22 and zk version 21 (kafka.controller.KafkaController)
[2017-01-22 14:16:38,183] INFO [Controller 0]: Controller 0 incremented epoch to 23 (kafka.controller.KafkaController)
[2017-01-22 14:16:38,183] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:16:38,189] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:16:38,190] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:16:38,195] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:16:38,196] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:16:38,197] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 23 (kafka.controller.KafkaController)
[2017-01-22 14:16:38,197] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:16:38,197] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:16:38,200] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:16:40,620] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:16:40,621] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:16:40,623] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:16:40,623] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:16:40,624] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:16:40,624] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:16:40,624] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:16:40,625] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:16:40,629] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:16:40,629] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":20,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:16:40,631] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:16:40,635] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:16:40,635] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:16:40,638] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:16:40,640] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:16:40,642] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:16:43,207] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:16:43,208] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:16:43,208] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:16:43,208] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:17:40,467] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:17:40,467] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:17:40,467] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:17:40,468] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:17:40,468] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:17:40,469] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:17:40,470] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:17:40,470] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:17:40,470] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:17:40,473] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:17:40,474] INFO [Controller 0]: Initialized controller epoch to 23 and zk version 22 (kafka.controller.KafkaController)
[2017-01-22 14:17:40,474] INFO [Controller 0]: Controller 0 incremented epoch to 24 (kafka.controller.KafkaController)
[2017-01-22 14:17:40,475] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:17:40,482] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:17:40,483] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:17:40,483] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:17:40,483] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:17:40,483] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:17:40,483] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:17:40,486] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:17:40,486] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:17:40,487] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 24 (kafka.controller.KafkaController)
[2017-01-22 14:17:40,487] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:17:40,487] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:17:40,490] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:17:42,616] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:17:42,617] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:17:42,619] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:17:42,620] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:17:42,620] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:17:42,621] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:17:42,621] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:17:42,621] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:17:42,624] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:17:42,625] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":21,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:17:42,626] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:17:42,628] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:17:42,628] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:17:42,632] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:17:42,634] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:17:42,636] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:17:45,497] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:17:45,497] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:17:45,497] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:17:45,497] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:18:42,768] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:18:42,768] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:18:42,768] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:18:42,768] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:18:42,768] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:18:42,771] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:18:42,772] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:18:42,772] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:18:42,772] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:18:42,778] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:18:42,778] INFO [Controller 0]: Initialized controller epoch to 24 and zk version 23 (kafka.controller.KafkaController)
[2017-01-22 14:18:42,779] INFO [Controller 0]: Controller 0 incremented epoch to 25 (kafka.controller.KafkaController)
[2017-01-22 14:18:42,779] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:18:42,786] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:18:42,787] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:18:42,790] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:18:42,791] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:18:42,791] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 25 (kafka.controller.KafkaController)
[2017-01-22 14:18:42,791] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:18:42,791] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:18:42,792] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:18:44,557] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:18:44,558] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:18:44,560] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:18:44,560] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:18:44,561] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:18:44,561] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:18:44,562] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:18:44,562] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:18:44,565] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:18:44,565] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":22,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:18:44,566] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:18:44,568] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:18:44,569] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:18:44,572] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:18:44,574] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:18:44,577] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:18:47,803] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:18:47,803] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:18:47,803] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:18:47,803] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:20:47,851] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:20:47,852] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:20:47,852] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:20:47,852] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:20:47,852] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:20:47,854] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:20:47,854] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:20:47,854] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:20:47,854] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:20:47,858] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:20:47,858] INFO [Controller 0]: Initialized controller epoch to 25 and zk version 24 (kafka.controller.KafkaController)
[2017-01-22 14:20:47,859] INFO [Controller 0]: Controller 0 incremented epoch to 26 (kafka.controller.KafkaController)
[2017-01-22 14:20:47,859] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:20:47,865] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:20:47,866] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:20:47,869] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:20:47,869] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:20:47,870] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 26 (kafka.controller.KafkaController)
[2017-01-22 14:20:47,870] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:20:47,870] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:20:47,870] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:20:49,500] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:20:49,501] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:20:49,504] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:20:49,504] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:20:49,505] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:20:49,506] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:20:49,506] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:20:49,507] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:20:49,510] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:20:49,510] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":23,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:20:49,512] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:20:49,514] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:20:49,514] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:20:49,517] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:20:49,519] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:20:49,521] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:20:52,877] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:20:52,877] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:20:52,877] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:20:52,877] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:21:51,262] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:21:51,262] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:21:51,262] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:21:51,263] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:21:51,263] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:21:51,265] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:21:51,265] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:21:51,265] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:21:51,265] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:21:51,268] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:21:51,268] INFO [Controller 0]: Initialized controller epoch to 26 and zk version 25 (kafka.controller.KafkaController)
[2017-01-22 14:21:51,269] INFO [Controller 0]: Controller 0 incremented epoch to 27 (kafka.controller.KafkaController)
[2017-01-22 14:21:51,269] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:21:51,274] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:21:51,275] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:21:51,277] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:21:51,278] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:21:51,278] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 27 (kafka.controller.KafkaController)
[2017-01-22 14:21:51,278] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:21:51,278] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:21:51,279] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:21:52,337] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:21:52,337] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:21:52,339] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:21:52,339] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:21:52,340] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:21:52,340] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:21:52,341] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:21:52,341] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:21:52,344] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:21:52,344] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":24,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:21:52,345] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:21:52,348] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:21:52,348] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:21:52,352] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:21:52,353] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:21:52,355] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:21:56,287] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:21:56,287] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:21:56,287] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:21:56,287] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:23:38,339] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:23:38,339] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:23:38,339] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:23:38,340] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:23:38,340] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:23:38,342] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:23:38,342] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:23:38,342] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:23:38,342] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:23:38,347] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:23:38,348] INFO [Controller 0]: Initialized controller epoch to 27 and zk version 26 (kafka.controller.KafkaController)
[2017-01-22 14:23:38,348] INFO [Controller 0]: Controller 0 incremented epoch to 28 (kafka.controller.KafkaController)
[2017-01-22 14:23:38,348] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:23:38,353] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:23:38,353] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:23:38,353] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:23:38,353] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:23:38,353] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:23:38,354] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:23:38,358] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:23:38,358] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:23:38,359] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 28 (kafka.controller.KafkaController)
[2017-01-22 14:23:38,359] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:23:38,359] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:23:38,359] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:23:40,553] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:23:40,554] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:23:40,556] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:23:40,556] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:23:40,557] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:23:40,557] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:23:40,558] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:23:40,558] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:23:40,561] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:23:40,561] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":25,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:23:40,562] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:23:40,564] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:23:40,564] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:23:40,567] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:23:40,568] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:23:40,570] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:23:43,364] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:23:43,364] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:23:43,364] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:23:43,364] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:24:40,379] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:24:40,380] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:24:40,380] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:24:40,380] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:24:40,380] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:24:40,383] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:24:40,384] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:24:40,384] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:24:40,384] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:24:40,387] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:24:40,388] INFO [Controller 0]: Initialized controller epoch to 28 and zk version 27 (kafka.controller.KafkaController)
[2017-01-22 14:24:40,388] INFO [Controller 0]: Controller 0 incremented epoch to 29 (kafka.controller.KafkaController)
[2017-01-22 14:24:40,389] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:24:40,393] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:24:40,394] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:24:40,396] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:24:40,397] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:24:40,397] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 29 (kafka.controller.KafkaController)
[2017-01-22 14:24:40,397] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:24:40,397] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:24:40,398] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:24:42,486] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:24:42,487] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:24:42,490] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:24:42,490] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:24:42,490] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:24:42,491] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:24:42,491] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:24:42,491] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:24:42,494] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:24:42,494] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":26,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:24:42,495] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:24:42,496] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:24:42,496] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:24:42,500] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:24:42,501] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:24:42,503] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:24:45,402] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:24:45,402] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:24:45,402] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:24:45,402] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:25:43,571] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:25:43,571] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:25:43,571] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:25:43,572] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:25:43,572] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:25:43,574] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:25:43,574] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:25:43,574] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:25:43,574] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:25:43,599] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:25:43,600] INFO [Controller 0]: Initialized controller epoch to 29 and zk version 28 (kafka.controller.KafkaController)
[2017-01-22 14:25:43,600] INFO [Controller 0]: Controller 0 incremented epoch to 30 (kafka.controller.KafkaController)
[2017-01-22 14:25:43,601] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:25:43,606] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:25:43,607] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:25:43,610] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:25:43,610] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:25:43,610] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 30 (kafka.controller.KafkaController)
[2017-01-22 14:25:43,610] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:25:43,610] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:25:43,611] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:25:45,767] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:25:45,768] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:25:45,771] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:25:45,771] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:25:45,772] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:25:45,772] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:25:45,773] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:25:45,773] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:25:45,777] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:25:45,777] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":27,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:25:45,779] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:25:45,783] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:25:45,783] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:25:45,787] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:25:45,790] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:25:45,792] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:25:48,619] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:25:48,619] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:25:48,619] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:25:48,620] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:26:45,510] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:26:45,510] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:26:45,510] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:26:45,510] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:26:45,510] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:26:45,512] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:26:45,512] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:26:45,512] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:26:45,512] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:26:45,515] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:26:45,516] INFO [Controller 0]: Initialized controller epoch to 30 and zk version 29 (kafka.controller.KafkaController)
[2017-01-22 14:26:45,516] INFO [Controller 0]: Controller 0 incremented epoch to 31 (kafka.controller.KafkaController)
[2017-01-22 14:26:45,516] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:26:45,522] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:26:45,523] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:26:45,523] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:26:45,523] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:26:45,523] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:26:45,523] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:26:45,526] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:26:45,527] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:26:45,527] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 31 (kafka.controller.KafkaController)
[2017-01-22 14:26:45,527] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:26:45,527] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:26:45,528] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:26:47,356] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:26:47,356] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:26:47,359] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:26:47,359] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:26:47,360] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:26:47,361] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:26:47,361] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:26:47,361] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:26:47,365] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:26:47,365] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":28,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:26:47,366] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:26:47,368] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:26:47,368] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:26:47,374] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:26:47,375] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:26:47,377] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:26:50,530] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:26:50,530] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:26:50,530] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:26:50,530] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:27:50,364] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:27:50,365] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:27:50,365] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:27:50,365] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:27:50,365] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:27:50,367] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:27:50,367] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:27:50,367] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:27:50,367] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:27:50,370] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:27:50,371] INFO [Controller 0]: Initialized controller epoch to 31 and zk version 30 (kafka.controller.KafkaController)
[2017-01-22 14:27:50,371] INFO [Controller 0]: Controller 0 incremented epoch to 32 (kafka.controller.KafkaController)
[2017-01-22 14:27:50,371] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:27:50,375] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:27:50,376] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:27:50,379] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:27:50,379] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:27:50,380] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 32 (kafka.controller.KafkaController)
[2017-01-22 14:27:50,380] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:27:50,380] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:27:50,381] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:27:51,679] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:27:51,679] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:27:51,681] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:27:51,681] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:27:51,682] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:27:51,682] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:27:51,682] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:27:51,683] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:27:51,685] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:27:51,685] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":29,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:27:51,686] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:27:51,688] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:27:51,688] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:27:51,691] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:27:51,693] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:27:51,695] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:27:55,391] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:27:55,391] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:27:55,392] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:27:55,392] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:28:53,055] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:28:53,055] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:28:53,055] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:28:53,055] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:28:53,055] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:28:53,057] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:28:53,057] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:28:53,057] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:28:53,057] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:28:53,059] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:28:53,060] INFO [Controller 0]: Initialized controller epoch to 32 and zk version 31 (kafka.controller.KafkaController)
[2017-01-22 14:28:53,061] INFO [Controller 0]: Controller 0 incremented epoch to 33 (kafka.controller.KafkaController)
[2017-01-22 14:28:53,061] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:28:53,065] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:28:53,069] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:28:53,070] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:28:53,070] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 33 (kafka.controller.KafkaController)
[2017-01-22 14:28:53,070] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:28:53,070] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:28:53,071] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:28:54,302] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:28:54,302] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:28:54,304] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:28:54,304] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:28:54,305] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:28:54,306] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:28:54,306] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:28:54,306] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:28:54,309] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:28:54,309] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":30,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:28:54,310] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:28:54,312] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:28:54,312] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:28:54,315] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:28:54,317] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:28:54,319] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:28:58,073] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:28:58,073] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:28:58,073] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:28:58,073] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:29:55,608] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:29:55,608] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:29:55,608] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:29:55,609] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:29:55,609] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:29:55,611] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:29:55,611] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:29:55,611] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:29:55,611] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:29:55,614] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:29:55,614] INFO [Controller 0]: Initialized controller epoch to 33 and zk version 32 (kafka.controller.KafkaController)
[2017-01-22 14:29:55,615] INFO [Controller 0]: Controller 0 incremented epoch to 34 (kafka.controller.KafkaController)
[2017-01-22 14:29:55,615] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:29:55,619] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:29:55,620] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:29:55,623] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:29:55,623] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:29:55,624] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 34 (kafka.controller.KafkaController)
[2017-01-22 14:29:55,624] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:29:55,624] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:29:55,625] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:29:57,686] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:29:57,687] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:29:57,690] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:29:57,690] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:29:57,691] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:29:57,691] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:29:57,692] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:29:57,692] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:29:57,696] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:29:57,696] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":31,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:29:57,697] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:29:57,699] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:29:57,699] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:29:57,702] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:29:57,704] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:29:57,706] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:30:00,634] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:30:00,634] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:30:00,634] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:30:00,634] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:30:57,784] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:30:57,784] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:30:57,784] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:30:57,785] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:30:57,785] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:30:57,787] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:30:57,787] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:30:57,787] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:30:57,787] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:30:57,789] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:30:57,790] INFO [Controller 0]: Initialized controller epoch to 34 and zk version 33 (kafka.controller.KafkaController)
[2017-01-22 14:30:57,790] INFO [Controller 0]: Controller 0 incremented epoch to 35 (kafka.controller.KafkaController)
[2017-01-22 14:30:57,791] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:30:57,795] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:30:57,795] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:30:57,795] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:30:57,796] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:30:57,799] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:30:57,800] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:30:57,800] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 35 (kafka.controller.KafkaController)
[2017-01-22 14:30:57,800] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:30:57,800] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:30:57,801] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:30:59,642] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:30:59,642] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:30:59,644] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:30:59,644] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:30:59,645] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:30:59,645] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:30:59,645] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:30:59,646] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:30:59,648] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:30:59,649] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":32,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:30:59,649] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:30:59,651] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:30:59,651] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:30:59,654] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:30:59,655] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:30:59,657] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:31:02,811] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:31:02,812] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:31:02,812] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:31:02,812] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:33:02,777] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:33:02,777] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:33:02,777] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:33:02,778] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:33:02,778] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:33:02,780] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:33:02,780] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:33:02,781] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:33:02,781] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:33:02,787] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:33:02,787] INFO [Controller 0]: Initialized controller epoch to 35 and zk version 34 (kafka.controller.KafkaController)
[2017-01-22 14:33:02,788] INFO [Controller 0]: Controller 0 incremented epoch to 36 (kafka.controller.KafkaController)
[2017-01-22 14:33:02,789] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:33:02,796] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:33:02,796] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:33:02,796] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:33:02,797] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:33:02,798] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:33:02,798] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:33:02,798] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:33:02,802] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:33:02,802] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:33:02,803] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 36 (kafka.controller.KafkaController)
[2017-01-22 14:33:02,803] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:33:02,803] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:33:02,804] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:33:04,721] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:33:04,722] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:33:04,724] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:33:04,724] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:33:04,725] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:33:04,725] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:33:04,725] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:33:04,725] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:33:04,728] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:33:04,728] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":33,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:33:04,729] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:33:04,730] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:33:04,730] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:33:04,733] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:33:04,735] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:33:04,737] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:33:07,814] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:33:07,814] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:33:07,814] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:33:07,814] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:34:05,535] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:34:05,535] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:34:05,535] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:34:05,535] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:34:05,535] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:34:05,541] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:34:05,542] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:34:05,542] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:34:05,542] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:34:05,572] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:34:05,573] INFO [Controller 0]: Initialized controller epoch to 36 and zk version 35 (kafka.controller.KafkaController)
[2017-01-22 14:34:05,575] INFO [Controller 0]: Controller 0 incremented epoch to 37 (kafka.controller.KafkaController)
[2017-01-22 14:34:05,575] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:34:05,586] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:34:05,586] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:34:05,586] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:34:05,588] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:34:05,588] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:34:05,588] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:34:05,589] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:34:05,589] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:34:05,589] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:34:05,589] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:34:05,589] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:34:05,590] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:34:05,598] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:34:05,598] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:34:05,599] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 37 (kafka.controller.KafkaController)
[2017-01-22 14:34:05,599] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:34:05,599] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:34:05,600] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:34:07,671] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:34:07,671] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:34:07,673] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:34:07,673] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:34:07,674] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:34:07,674] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:34:07,674] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:34:07,675] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:34:07,677] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:34:07,677] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":34,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:34:07,679] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:34:07,680] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:34:07,681] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:34:07,683] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:34:07,685] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:34:07,687] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:34:10,601] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:34:10,601] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:34:10,601] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:34:10,601] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:35:07,372] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:35:07,372] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:35:07,372] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:35:07,373] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:35:07,373] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:35:07,376] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:35:07,376] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:35:07,376] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:35:07,377] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:35:07,378] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:35:07,379] INFO [Controller 0]: Initialized controller epoch to 37 and zk version 36 (kafka.controller.KafkaController)
[2017-01-22 14:35:07,380] INFO [Controller 0]: Controller 0 incremented epoch to 38 (kafka.controller.KafkaController)
[2017-01-22 14:35:07,380] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:35:07,384] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:35:07,385] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:35:07,385] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:35:07,388] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:35:07,388] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:35:07,388] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 38 (kafka.controller.KafkaController)
[2017-01-22 14:35:07,388] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:35:07,388] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:35:07,389] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:35:09,623] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:35:09,624] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:35:09,626] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:35:09,626] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:35:09,627] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:35:09,627] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:35:09,627] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:35:09,627] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:35:09,630] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:35:09,630] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":35,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:35:09,631] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:35:09,632] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:35:09,632] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:35:09,635] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:35:09,637] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:35:09,638] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:35:12,400] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:35:12,400] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:35:12,400] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:35:12,400] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:36:10,092] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:36:10,092] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:36:10,092] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:36:10,092] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:36:10,092] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:36:10,094] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:36:10,094] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:36:10,094] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:36:10,095] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:36:10,126] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:36:10,127] INFO [Controller 0]: Initialized controller epoch to 38 and zk version 37 (kafka.controller.KafkaController)
[2017-01-22 14:36:10,128] INFO [Controller 0]: Controller 0 incremented epoch to 39 (kafka.controller.KafkaController)
[2017-01-22 14:36:10,128] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:36:10,133] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:36:10,133] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:36:10,133] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:36:10,134] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:36:10,137] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:36:10,137] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:36:10,137] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 39 (kafka.controller.KafkaController)
[2017-01-22 14:36:10,137] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:36:10,137] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:36:10,138] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:36:11,503] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:36:11,504] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:36:11,506] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:36:11,507] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:36:11,508] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:36:11,508] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:36:11,508] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:36:11,509] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:36:11,512] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:36:11,512] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":36,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:36:11,513] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:36:11,514] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:36:11,515] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:36:11,518] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:36:11,519] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:36:11,522] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:36:15,139] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:36:15,139] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:36:15,139] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:36:15,140] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:38:15,032] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:38:15,032] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:38:15,032] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:38:15,033] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:38:15,033] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:38:15,035] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:38:15,035] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:38:15,035] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:38:15,035] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:38:15,037] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:38:15,038] INFO [Controller 0]: Initialized controller epoch to 39 and zk version 38 (kafka.controller.KafkaController)
[2017-01-22 14:38:15,039] INFO [Controller 0]: Controller 0 incremented epoch to 40 (kafka.controller.KafkaController)
[2017-01-22 14:38:15,039] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:38:15,044] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:38:15,044] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:38:15,044] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:38:15,045] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:38:15,048] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:38:15,048] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:38:15,049] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 40 (kafka.controller.KafkaController)
[2017-01-22 14:38:15,049] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:38:15,049] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:38:15,049] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:38:16,388] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:38:16,388] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:38:16,390] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:38:16,390] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:38:16,391] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:38:16,391] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:38:16,392] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:38:16,392] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:38:16,394] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:38:16,394] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":37,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:38:16,397] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:38:16,398] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:38:16,399] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:38:16,402] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:38:16,404] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:38:16,406] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:38:20,055] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:38:20,055] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:38:20,055] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:38:20,055] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:39:16,813] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:39:16,813] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:39:16,813] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:39:16,814] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:39:16,814] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:39:16,816] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:39:16,816] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:39:16,816] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:39:16,816] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:39:16,819] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:39:16,820] INFO [Controller 0]: Initialized controller epoch to 40 and zk version 39 (kafka.controller.KafkaController)
[2017-01-22 14:39:16,820] INFO [Controller 0]: Controller 0 incremented epoch to 41 (kafka.controller.KafkaController)
[2017-01-22 14:39:16,821] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:39:16,826] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:39:16,827] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:39:16,830] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:39:16,830] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:39:16,830] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 41 (kafka.controller.KafkaController)
[2017-01-22 14:39:16,830] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:39:16,830] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:39:16,831] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:39:18,619] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:39:18,619] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:39:18,621] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:39:18,621] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:39:18,622] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:39:18,623] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:39:18,623] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:39:18,623] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:39:18,626] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:39:18,626] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":38,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:39:18,627] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:39:18,629] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:39:18,629] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:39:18,632] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:39:18,634] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:39:18,636] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:39:21,841] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:39:21,842] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:39:21,842] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:39:21,842] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:40:18,659] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:40:18,660] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:40:18,660] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:40:18,660] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:40:18,660] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:40:18,663] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:40:18,664] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:40:18,664] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:40:18,664] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:40:18,668] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:40:18,669] INFO [Controller 0]: Initialized controller epoch to 41 and zk version 40 (kafka.controller.KafkaController)
[2017-01-22 14:40:18,671] INFO [Controller 0]: Controller 0 incremented epoch to 42 (kafka.controller.KafkaController)
[2017-01-22 14:40:18,671] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:40:18,682] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:40:18,683] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:40:18,683] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:40:18,683] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:40:18,683] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:40:18,686] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:40:18,686] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:40:18,686] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 42 (kafka.controller.KafkaController)
[2017-01-22 14:40:18,687] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:40:18,687] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:40:18,687] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:40:20,284] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:40:20,285] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:40:20,288] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:40:20,288] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:40:20,289] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:40:20,289] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:40:20,291] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:40:20,292] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:40:20,299] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:40:20,299] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":39,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:40:20,300] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:40:20,301] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:40:20,302] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:40:20,305] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:40:20,306] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:40:20,308] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:40:23,688] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:40:23,689] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:40:23,689] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:40:23,689] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:43:26,375] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:43:26,375] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:43:26,375] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:43:26,376] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:43:26,376] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:43:26,378] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:43:26,378] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:43:26,378] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:43:26,379] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:43:26,385] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:43:26,385] INFO [Controller 0]: Initialized controller epoch to 42 and zk version 41 (kafka.controller.KafkaController)
[2017-01-22 14:43:26,386] INFO [Controller 0]: Controller 0 incremented epoch to 43 (kafka.controller.KafkaController)
[2017-01-22 14:43:26,386] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:43:26,397] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:43:26,397] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:43:26,397] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:43:26,398] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:43:26,402] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:43:26,403] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:43:26,403] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 43 (kafka.controller.KafkaController)
[2017-01-22 14:43:26,403] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:43:26,403] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:43:26,404] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:43:28,534] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:43:28,535] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:43:28,536] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:43:28,536] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:43:28,537] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:43:28,537] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:43:28,537] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:43:28,538] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:43:28,540] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:43:28,541] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":40,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:43:28,541] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:43:28,543] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:43:28,543] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:43:28,547] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:43:28,548] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:43:28,573] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:43:31,411] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:43:31,411] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:43:31,411] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:43:31,411] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:44:28,702] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:44:28,702] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:44:28,702] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:44:28,702] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:44:28,702] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:44:28,708] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:44:28,708] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:44:28,708] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:44:28,708] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:44:28,713] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:44:28,714] INFO [Controller 0]: Initialized controller epoch to 43 and zk version 42 (kafka.controller.KafkaController)
[2017-01-22 14:44:28,715] INFO [Controller 0]: Controller 0 incremented epoch to 44 (kafka.controller.KafkaController)
[2017-01-22 14:44:28,715] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:44:28,721] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:44:28,722] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:44:28,725] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:44:28,726] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:44:28,726] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 44 (kafka.controller.KafkaController)
[2017-01-22 14:44:28,726] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:44:28,726] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:44:28,727] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:44:30,591] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:44:30,591] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:44:30,594] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:44:30,594] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:44:30,594] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:44:30,595] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:44:30,595] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:44:30,595] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:44:30,599] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:44:30,599] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":41,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:44:30,600] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:44:30,601] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:44:30,601] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:44:30,605] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:44:30,606] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:44:30,608] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:44:33,731] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:44:33,731] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:44:33,731] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:44:33,731] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:45:31,853] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:45:31,853] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:45:31,853] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:45:31,854] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:45:31,854] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:45:31,855] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:45:31,855] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:45:31,855] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:45:31,855] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:45:31,858] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:45:31,859] INFO [Controller 0]: Initialized controller epoch to 44 and zk version 43 (kafka.controller.KafkaController)
[2017-01-22 14:45:31,860] INFO [Controller 0]: Controller 0 incremented epoch to 45 (kafka.controller.KafkaController)
[2017-01-22 14:45:31,860] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:45:31,868] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:45:31,868] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:45:31,868] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:45:31,868] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:45:31,869] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:45:31,874] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:45:31,874] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:45:31,875] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 45 (kafka.controller.KafkaController)
[2017-01-22 14:45:31,875] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:45:31,875] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:45:31,876] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:45:33,503] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:45:33,504] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:45:33,509] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:45:33,509] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:45:33,510] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:45:33,511] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:45:33,511] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:45:33,512] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:45:33,517] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:45:33,517] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":42,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:45:33,519] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:45:33,524] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:45:33,524] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:45:33,528] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:45:33,531] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:45:33,535] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:45:36,881] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:45:36,882] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:45:36,882] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:45:36,882] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:46:33,670] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:46:33,672] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:46:33,672] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:46:33,672] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:46:33,672] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:46:33,674] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:46:33,675] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:46:33,675] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:46:33,675] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:46:33,679] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:46:33,679] INFO [Controller 0]: Initialized controller epoch to 45 and zk version 44 (kafka.controller.KafkaController)
[2017-01-22 14:46:33,682] INFO [Controller 0]: Controller 0 incremented epoch to 46 (kafka.controller.KafkaController)
[2017-01-22 14:46:33,683] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:46:33,689] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:46:33,690] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:46:33,695] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:46:33,695] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:46:33,696] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 46 (kafka.controller.KafkaController)
[2017-01-22 14:46:33,696] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:46:33,696] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:46:33,697] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:46:35,221] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:46:35,222] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:46:35,224] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:46:35,224] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:46:35,225] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:46:35,225] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:46:35,225] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:46:35,226] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:46:35,229] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:46:35,229] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":43,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:46:35,230] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:46:35,233] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:46:35,233] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:46:35,237] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:46:35,238] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:46:35,241] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:46:38,707] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:46:38,708] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:46:38,708] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:46:38,708] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:49:42,228] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:49:42,228] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:49:42,228] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:49:42,228] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:49:42,229] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:49:42,230] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:49:42,230] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:49:42,230] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:49:42,230] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:49:42,233] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:49:42,234] INFO [Controller 0]: Initialized controller epoch to 46 and zk version 45 (kafka.controller.KafkaController)
[2017-01-22 14:49:42,234] INFO [Controller 0]: Controller 0 incremented epoch to 47 (kafka.controller.KafkaController)
[2017-01-22 14:49:42,235] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:49:42,239] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:49:42,240] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:49:42,243] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:49:42,243] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:49:42,244] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 47 (kafka.controller.KafkaController)
[2017-01-22 14:49:42,244] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:49:42,244] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:49:42,244] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:49:43,783] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:49:43,783] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:49:43,786] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:49:43,786] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:49:43,786] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:49:43,787] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:49:43,787] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:49:43,787] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:49:43,790] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:49:43,790] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":44,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:49:43,791] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:49:43,794] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:49:43,794] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:49:43,798] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:49:43,800] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:49:43,803] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:49:47,251] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:49:47,251] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:49:47,251] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:49:47,251] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:50:44,159] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:50:44,159] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:50:44,159] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:50:44,160] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:50:44,160] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:50:44,161] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:50:44,161] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:50:44,161] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:50:44,162] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:50:44,174] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:50:44,175] INFO [Controller 0]: Initialized controller epoch to 47 and zk version 46 (kafka.controller.KafkaController)
[2017-01-22 14:50:44,176] INFO [Controller 0]: Controller 0 incremented epoch to 48 (kafka.controller.KafkaController)
[2017-01-22 14:50:44,176] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:50:44,182] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:50:44,182] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:50:44,182] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:50:44,182] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:50:44,183] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:50:44,189] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:50:44,189] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:50:44,190] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 48 (kafka.controller.KafkaController)
[2017-01-22 14:50:44,190] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:50:44,190] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:50:44,191] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:50:46,694] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:50:46,695] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:50:46,698] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:50:46,698] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:50:46,698] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:50:46,699] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:50:46,699] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:50:46,699] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:50:46,702] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:50:46,702] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":45,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:50:46,703] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:50:46,704] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:50:46,704] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:50:46,708] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:50:46,709] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:50:46,712] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:50:49,192] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:50:49,192] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:50:49,192] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:50:49,192] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:51:45,639] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:51:45,639] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:51:45,639] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:51:45,640] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:51:45,640] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:51:45,642] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:51:45,642] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:51:45,642] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:51:45,642] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:51:45,645] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:51:45,646] INFO [Controller 0]: Initialized controller epoch to 48 and zk version 47 (kafka.controller.KafkaController)
[2017-01-22 14:51:45,647] INFO [Controller 0]: Controller 0 incremented epoch to 49 (kafka.controller.KafkaController)
[2017-01-22 14:51:45,647] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:51:45,657] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:51:45,657] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:51:45,657] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:51:45,658] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:51:45,663] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:51:45,664] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:51:45,664] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 49 (kafka.controller.KafkaController)
[2017-01-22 14:51:45,664] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:51:45,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:51:45,666] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:51:47,714] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:51:47,714] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:51:47,717] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:51:47,717] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:51:47,717] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:51:47,718] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:51:47,718] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:51:47,718] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:51:47,721] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:51:47,721] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":46,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:51:47,721] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:51:47,722] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:51:47,723] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:51:47,725] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:51:47,727] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:51:47,729] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:51:50,673] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:51:50,674] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:51:50,674] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:51:50,674] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:54:53,470] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:54:53,470] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:54:53,470] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:54:53,471] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:54:53,471] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:54:53,472] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:54:53,472] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:54:53,472] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:54:53,472] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:54:53,475] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:54:53,476] INFO [Controller 0]: Initialized controller epoch to 49 and zk version 48 (kafka.controller.KafkaController)
[2017-01-22 14:54:53,477] INFO [Controller 0]: Controller 0 incremented epoch to 50 (kafka.controller.KafkaController)
[2017-01-22 14:54:53,477] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:54:53,481] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:54:53,484] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:54:53,485] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:54:53,485] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 50 (kafka.controller.KafkaController)
[2017-01-22 14:54:53,485] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:54:53,485] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:54:53,485] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:54:55,729] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:54:55,729] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:54:55,732] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:54:55,732] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:54:55,733] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:54:55,733] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:54:55,733] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:54:55,734] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:54:55,736] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:54:55,736] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":47,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:54:55,737] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:54:55,739] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:54:55,739] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:54:55,743] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:54:55,744] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:54:55,747] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:54:58,496] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:54:58,496] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:54:58,496] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:54:58,496] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:55:55,338] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:55:55,340] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:55:55,340] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:55:55,340] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:55:55,340] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:55:55,343] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:55:55,343] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:55:55,344] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:55:55,344] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:55:55,350] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:55:55,350] INFO [Controller 0]: Initialized controller epoch to 50 and zk version 49 (kafka.controller.KafkaController)
[2017-01-22 14:55:55,351] INFO [Controller 0]: Controller 0 incremented epoch to 51 (kafka.controller.KafkaController)
[2017-01-22 14:55:55,352] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:55:55,357] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:55:55,358] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:55:55,362] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:55:55,362] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:55:55,362] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 51 (kafka.controller.KafkaController)
[2017-01-22 14:55:55,363] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:55:55,363] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:55:55,363] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:55:57,320] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:55:57,320] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:55:57,323] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:55:57,323] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:55:57,323] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:55:57,323] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:55:57,324] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:55:57,324] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:55:57,327] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:55:57,327] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":48,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:55:57,328] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:55:57,330] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:55:57,330] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:55:57,334] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:55:57,335] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:55:57,338] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:56:00,364] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:56:00,364] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:56:00,364] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:56:00,364] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:56:58,613] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:56:58,614] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:56:58,614] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:56:58,614] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:56:58,614] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:56:58,616] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:56:58,616] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:56:58,616] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:56:58,616] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:56:58,617] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:56:58,618] INFO [Controller 0]: Initialized controller epoch to 51 and zk version 50 (kafka.controller.KafkaController)
[2017-01-22 14:56:58,618] INFO [Controller 0]: Controller 0 incremented epoch to 52 (kafka.controller.KafkaController)
[2017-01-22 14:56:58,619] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:56:58,622] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:56:58,622] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:56:58,622] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:56:58,623] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:56:58,627] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:56:58,627] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:56:58,628] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 52 (kafka.controller.KafkaController)
[2017-01-22 14:56:58,628] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:56:58,628] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:56:58,629] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:57:00,621] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:57:00,621] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:57:00,623] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:57:00,623] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:57:00,624] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:57:00,624] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:57:00,625] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:57:00,625] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:57:00,627] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:57:00,627] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":49,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:57:00,628] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:57:00,630] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:57:00,630] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:57:00,633] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:57:00,634] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:57:00,635] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:57:03,639] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:57:03,640] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:57:03,640] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:57:03,640] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:58:01,408] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:58:01,410] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:58:01,410] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:58:01,410] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:58:01,410] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:58:01,411] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:58:01,412] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:58:01,412] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:58:01,412] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:58:01,414] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:58:01,414] INFO [Controller 0]: Initialized controller epoch to 52 and zk version 51 (kafka.controller.KafkaController)
[2017-01-22 14:58:01,415] INFO [Controller 0]: Controller 0 incremented epoch to 53 (kafka.controller.KafkaController)
[2017-01-22 14:58:01,415] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:58:01,418] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:58:01,422] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:58:01,423] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:58:01,423] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 53 (kafka.controller.KafkaController)
[2017-01-22 14:58:01,423] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:58:01,423] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:58:01,424] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:58:03,620] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:58:03,621] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:58:03,623] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:58:03,623] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:58:03,623] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:58:03,624] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:58:03,624] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:58:03,624] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:58:03,627] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:58:03,627] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":50,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:58:03,629] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:58:03,631] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:58:03,631] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:58:03,633] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:58:03,634] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:58:03,635] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:58:06,432] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:58:06,432] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:58:06,432] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:58:06,433] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-01-22 14:59:03,675] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-01-22 14:59:03,676] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-01-22 14:59:03,676] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:59:03,676] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-01-22 14:59:03,676] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:59:03,677] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-01-22 14:59:03,677] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-01-22 14:59:03,677] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-01-22 14:59:03,678] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-01-22 14:59:03,689] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-01-22 14:59:03,690] INFO [Controller 0]: Initialized controller epoch to 53 and zk version 52 (kafka.controller.KafkaController)
[2017-01-22 14:59:03,690] INFO [Controller 0]: Controller 0 incremented epoch to 54 (kafka.controller.KafkaController)
[2017-01-22 14:59:03,690] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Partitions already reassigned: Set() (kafka.controller.KafkaController)
[2017-01-22 14:59:03,694] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Controller 0]: List of topics ineligible for deletion: twitterstream (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Controller 0]: Current list of topics in the cluster: Set(twitterstream) (kafka.controller.KafkaController)
[2017-01-22 14:59:03,695] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=twitterstream,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:59:03,697] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [twitterstream,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:59:03,697] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([twitterstream,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:59:03,698] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 54 (kafka.controller.KafkaController)
[2017-01-22 14:59:03,698] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-01-22 14:59:03,698] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-01-22 14:59:03,698] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-01-22 14:59:05,537] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-01-22 14:59:05,537] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:59:05,539] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:59:05,539] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-01-22 14:59:05,539] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-01-22 14:59:05,540] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-01-22 14:59:05,540] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=twitterstream,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-01-22 14:59:05,540] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-01-22 14:59:05,542] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [twitterstream,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:59:05,542] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":51,"isr":[0]} for offline partition [twitterstream,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-01-22 14:59:05,543] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([twitterstream,0] -> (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:54)) (kafka.controller.PartitionStateMachine)
[2017-01-22 14:59:05,544] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children twitterstream (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:59:05,545] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-01-22 14:59:05,548] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/twitterstream (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-01-22 14:59:05,549] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:59:05,550] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-01-22 14:59:08,701] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-01-22 14:59:08,702] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([twitterstream,0] -> List(0))) (kafka.controller.KafkaController)
[2017-01-22 14:59:08,703] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-01-22 14:59:08,703] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
