[2017-01-22 14:09:22,192] TRACE Controller 0 epoch 19 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:22,197] ERROR Controller 0 epoch 19 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:09:24,414] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:18) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:09:24,414] TRACE Controller 0 epoch 19 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:09:24,414] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:18) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,414] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:18) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:09:24,415] TRACE Controller 0 epoch 19 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,415] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 0 (state.change.logger)
[2017-01-22 14:09:24,416] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:09:24,416] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=18, leader=0, leaderEpoch=15, isr=[0], zkVersion=15, replicas=[0]) correlation id 1 from controller 0 epoch 19 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,416] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 19 for partition [twitterstream,0] since its associated leader epoch 15 is not higher than the current leader epoch 15 (state.change.logger)
[2017-01-22 14:09:24,417] TRACE Controller 0 epoch 19 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:09:24,418] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:15,ControllerEpoch:18),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 2 (state.change.logger)
[2017-01-22 14:09:24,418] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:09:24,418] TRACE Controller 0 epoch 19 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,418] TRACE Controller 0 epoch 19 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:09:24,418] TRACE Controller 0 epoch 19 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,419] TRACE Controller 0 epoch 19 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:09:24,419] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 3 from controller 0 epoch 19 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,419] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 19 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,420] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 19 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:09:24,420] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 19 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:09:24,421] TRACE Controller 0 epoch 19 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:09:24,421] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 19 with correlation id 4 (state.change.logger)
[2017-01-22 14:09:24,421] TRACE Controller 0 epoch 19 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:11:26,766] TRACE Controller 0 epoch 20 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:26,772] ERROR Controller 0 epoch 20 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:11:28,545] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:11:28,545] TRACE Controller 0 epoch 20 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:11:28,545] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,545] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:11:28,545] TRACE Controller 0 epoch 20 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,546] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2017-01-22 14:11:28,547] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:11:28,547] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=19, leader=0, leaderEpoch=16, isr=[0], zkVersion=16, replicas=[0]) correlation id 1 from controller 0 epoch 20 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,547] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 20 for partition [twitterstream,0] since its associated leader epoch 16 is not higher than the current leader epoch 16 (state.change.logger)
[2017-01-22 14:11:28,548] TRACE Controller 0 epoch 20 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:11:28,548] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:16,ControllerEpoch:19),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2017-01-22 14:11:28,549] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:11:28,549] TRACE Controller 0 epoch 20 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,549] TRACE Controller 0 epoch 20 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:11:28,549] TRACE Controller 0 epoch 20 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,550] TRACE Controller 0 epoch 20 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:11:28,550] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=20, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 3 from controller 0 epoch 20 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,550] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 20 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,550] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 20 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:11:28,551] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 20 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:11:28,551] TRACE Controller 0 epoch 20 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:11:28,552] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2017-01-22 14:11:28,552] TRACE Controller 0 epoch 20 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:12:28,312] TRACE Controller 0 epoch 21 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:28,315] ERROR Controller 0 epoch 21 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:12:30,560] TRACE Controller 0 epoch 21 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:12:30,560] TRACE Controller 0 epoch 21 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:12:30,560] TRACE Controller 0 epoch 21 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,560] TRACE Controller 0 epoch 21 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:12:30,561] TRACE Controller 0 epoch 21 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,561] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 21 with correlation id 0 (state.change.logger)
[2017-01-22 14:12:30,562] TRACE Controller 0 epoch 21 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:12:30,562] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=20, leader=0, leaderEpoch=17, isr=[0], zkVersion=17, replicas=[0]) correlation id 1 from controller 0 epoch 21 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,562] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 21 for partition [twitterstream,0] since its associated leader epoch 17 is not higher than the current leader epoch 17 (state.change.logger)
[2017-01-22 14:12:30,563] TRACE Controller 0 epoch 21 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:12:30,563] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:17,ControllerEpoch:20),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 21 with correlation id 2 (state.change.logger)
[2017-01-22 14:12:30,564] TRACE Controller 0 epoch 21 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:12:30,565] TRACE Controller 0 epoch 21 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,565] TRACE Controller 0 epoch 21 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:12:30,565] TRACE Controller 0 epoch 21 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,565] TRACE Controller 0 epoch 21 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:12:30,566] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=21, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 3 from controller 0 epoch 21 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 21 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,566] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 21 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:12:30,566] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 21 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:12:30,567] TRACE Controller 0 epoch 21 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:12:30,567] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 21 with correlation id 4 (state.change.logger)
[2017-01-22 14:12:30,568] TRACE Controller 0 epoch 21 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:13:30,528] TRACE Controller 0 epoch 22 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:30,548] ERROR Controller 0 epoch 22 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:13:32,640] TRACE Controller 0 epoch 22 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:13:32,640] TRACE Controller 0 epoch 22 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:13:32,640] TRACE Controller 0 epoch 22 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,641] TRACE Controller 0 epoch 22 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:13:32,641] TRACE Controller 0 epoch 22 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,642] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 22 with correlation id 0 (state.change.logger)
[2017-01-22 14:13:32,642] TRACE Controller 0 epoch 22 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:13:32,643] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=21, leader=0, leaderEpoch=18, isr=[0], zkVersion=18, replicas=[0]) correlation id 1 from controller 0 epoch 22 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,643] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 22 for partition [twitterstream,0] since its associated leader epoch 18 is not higher than the current leader epoch 18 (state.change.logger)
[2017-01-22 14:13:32,643] TRACE Controller 0 epoch 22 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:13:32,644] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:18,ControllerEpoch:21),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 22 with correlation id 2 (state.change.logger)
[2017-01-22 14:13:32,644] TRACE Controller 0 epoch 22 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:13:32,645] TRACE Controller 0 epoch 22 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,645] TRACE Controller 0 epoch 22 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:13:32,645] TRACE Controller 0 epoch 22 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,645] TRACE Controller 0 epoch 22 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:13:32,646] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=22, leader=0, leaderEpoch=19, isr=[0], zkVersion=19, replicas=[0]) correlation id 3 from controller 0 epoch 22 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,646] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 22 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,646] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 22 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:13:32,646] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 22 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:13:32,647] TRACE Controller 0 epoch 22 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:13:32,647] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 22 with correlation id 4 (state.change.logger)
[2017-01-22 14:13:32,648] TRACE Controller 0 epoch 22 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:16:38,190] TRACE Controller 0 epoch 23 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:38,196] ERROR Controller 0 epoch 23 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:16:40,624] TRACE Controller 0 epoch 23 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:16:40,625] TRACE Controller 0 epoch 23 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:16:40,625] TRACE Controller 0 epoch 23 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,625] TRACE Controller 0 epoch 23 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:16:40,625] TRACE Controller 0 epoch 23 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 0 (state.change.logger)
[2017-01-22 14:16:40,627] TRACE Controller 0 epoch 23 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:16:40,628] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=22, leader=0, leaderEpoch=19, isr=[0], zkVersion=19, replicas=[0]) correlation id 1 from controller 0 epoch 23 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,628] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 23 for partition [twitterstream,0] since its associated leader epoch 19 is not higher than the current leader epoch 19 (state.change.logger)
[2017-01-22 14:16:40,628] TRACE Controller 0 epoch 23 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:16:40,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:19,ControllerEpoch:22),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2017-01-22 14:16:40,631] TRACE Controller 0 epoch 23 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:16:40,631] TRACE Controller 0 epoch 23 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,631] TRACE Controller 0 epoch 23 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:16:40,631] TRACE Controller 0 epoch 23 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,631] TRACE Controller 0 epoch 23 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:16:40,632] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=23, leader=0, leaderEpoch=20, isr=[0], zkVersion=20, replicas=[0]) correlation id 3 from controller 0 epoch 23 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,632] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 23 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,633] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 23 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:16:40,633] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 23 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:16:40,633] TRACE Controller 0 epoch 23 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:16:40,634] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2017-01-22 14:16:40,634] TRACE Controller 0 epoch 23 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:17:40,483] TRACE Controller 0 epoch 24 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:40,486] ERROR Controller 0 epoch 24 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:17:42,621] TRACE Controller 0 epoch 24 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:17:42,621] TRACE Controller 0 epoch 24 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:17:42,621] TRACE Controller 0 epoch 24 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,621] TRACE Controller 0 epoch 24 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:17:42,622] TRACE Controller 0 epoch 24 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,622] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 24 with correlation id 0 (state.change.logger)
[2017-01-22 14:17:42,623] TRACE Controller 0 epoch 24 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:17:42,623] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=23, leader=0, leaderEpoch=20, isr=[0], zkVersion=20, replicas=[0]) correlation id 1 from controller 0 epoch 24 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,623] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 24 for partition [twitterstream,0] since its associated leader epoch 20 is not higher than the current leader epoch 20 (state.change.logger)
[2017-01-22 14:17:42,623] TRACE Controller 0 epoch 24 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:17:42,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:20,ControllerEpoch:23),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 24 with correlation id 2 (state.change.logger)
[2017-01-22 14:17:42,624] TRACE Controller 0 epoch 24 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:17:42,625] TRACE Controller 0 epoch 24 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,626] TRACE Controller 0 epoch 24 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:17:42,626] TRACE Controller 0 epoch 24 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,626] TRACE Controller 0 epoch 24 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:17:42,626] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=24, leader=0, leaderEpoch=21, isr=[0], zkVersion=21, replicas=[0]) correlation id 3 from controller 0 epoch 24 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,626] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 24 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,627] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 24 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:17:42,627] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 24 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:17:42,627] TRACE Controller 0 epoch 24 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:17:42,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 24 with correlation id 4 (state.change.logger)
[2017-01-22 14:17:42,628] TRACE Controller 0 epoch 24 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:18:42,787] TRACE Controller 0 epoch 25 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:42,790] ERROR Controller 0 epoch 25 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:18:44,561] TRACE Controller 0 epoch 25 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:18:44,562] TRACE Controller 0 epoch 25 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:18:44,562] TRACE Controller 0 epoch 25 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,562] TRACE Controller 0 epoch 25 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:18:44,562] TRACE Controller 0 epoch 25 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,563] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 25 with correlation id 0 (state.change.logger)
[2017-01-22 14:18:44,563] TRACE Controller 0 epoch 25 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:18:44,564] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=24, leader=0, leaderEpoch=21, isr=[0], zkVersion=21, replicas=[0]) correlation id 1 from controller 0 epoch 25 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,564] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 25 for partition [twitterstream,0] since its associated leader epoch 21 is not higher than the current leader epoch 21 (state.change.logger)
[2017-01-22 14:18:44,564] TRACE Controller 0 epoch 25 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:18:44,565] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:21,ControllerEpoch:24),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 25 with correlation id 2 (state.change.logger)
[2017-01-22 14:18:44,565] TRACE Controller 0 epoch 25 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:18:44,566] TRACE Controller 0 epoch 25 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,566] TRACE Controller 0 epoch 25 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:18:44,566] TRACE Controller 0 epoch 25 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,566] TRACE Controller 0 epoch 25 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:18:44,566] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=25, leader=0, leaderEpoch=22, isr=[0], zkVersion=22, replicas=[0]) correlation id 3 from controller 0 epoch 25 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,567] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 25 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 25 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:18:44,567] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 25 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:18:44,568] TRACE Controller 0 epoch 25 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:18:44,568] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 25 with correlation id 4 (state.change.logger)
[2017-01-22 14:18:44,569] TRACE Controller 0 epoch 25 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:20:47,866] TRACE Controller 0 epoch 26 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:47,869] ERROR Controller 0 epoch 26 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:20:49,505] TRACE Controller 0 epoch 26 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:20:49,506] TRACE Controller 0 epoch 26 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:20:49,507] TRACE Controller 0 epoch 26 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,507] TRACE Controller 0 epoch 26 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:20:49,507] TRACE Controller 0 epoch 26 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,508] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 0 (state.change.logger)
[2017-01-22 14:20:49,509] TRACE Controller 0 epoch 26 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:20:49,509] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=25, leader=0, leaderEpoch=22, isr=[0], zkVersion=22, replicas=[0]) correlation id 1 from controller 0 epoch 26 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,509] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 26 for partition [twitterstream,0] since its associated leader epoch 22 is not higher than the current leader epoch 22 (state.change.logger)
[2017-01-22 14:20:49,510] TRACE Controller 0 epoch 26 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:20:49,510] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:22,ControllerEpoch:25),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 2 (state.change.logger)
[2017-01-22 14:20:49,510] TRACE Controller 0 epoch 26 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:20:49,511] TRACE Controller 0 epoch 26 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,512] TRACE Controller 0 epoch 26 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:20:49,512] TRACE Controller 0 epoch 26 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,512] TRACE Controller 0 epoch 26 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:20:49,512] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=26, leader=0, leaderEpoch=23, isr=[0], zkVersion=23, replicas=[0]) correlation id 3 from controller 0 epoch 26 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,512] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 26 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,513] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 26 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:20:49,513] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 26 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:20:49,513] TRACE Controller 0 epoch 26 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:20:49,514] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 4 (state.change.logger)
[2017-01-22 14:20:49,514] TRACE Controller 0 epoch 26 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:21:51,275] TRACE Controller 0 epoch 27 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:51,277] ERROR Controller 0 epoch 27 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:21:52,340] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:21:52,341] TRACE Controller 0 epoch 27 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:21:52,341] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,341] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:21:52,341] TRACE Controller 0 epoch 27 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,342] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 0 (state.change.logger)
[2017-01-22 14:21:52,342] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:21:52,343] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=26, leader=0, leaderEpoch=23, isr=[0], zkVersion=23, replicas=[0]) correlation id 1 from controller 0 epoch 27 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,343] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 27 for partition [twitterstream,0] since its associated leader epoch 23 is not higher than the current leader epoch 23 (state.change.logger)
[2017-01-22 14:21:52,344] TRACE Controller 0 epoch 27 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:21:52,344] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:23,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 2 (state.change.logger)
[2017-01-22 14:21:52,345] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:21:52,345] TRACE Controller 0 epoch 27 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,346] TRACE Controller 0 epoch 27 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:21:52,346] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,346] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:21:52,346] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=27, leader=0, leaderEpoch=24, isr=[0], zkVersion=24, replicas=[0]) correlation id 3 from controller 0 epoch 27 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,347] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 27 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,347] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 27 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:21:52,347] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 27 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:21:52,348] TRACE Controller 0 epoch 27 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:21:52,348] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 4 (state.change.logger)
[2017-01-22 14:21:52,349] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:23:38,354] TRACE Controller 0 epoch 28 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:38,358] ERROR Controller 0 epoch 28 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:23:40,557] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:23:40,558] TRACE Controller 0 epoch 28 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:23:40,558] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,558] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:23:40,558] TRACE Controller 0 epoch 28 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,559] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 0 (state.change.logger)
[2017-01-22 14:23:40,559] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:23:40,559] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=27, leader=0, leaderEpoch=24, isr=[0], zkVersion=24, replicas=[0]) correlation id 1 from controller 0 epoch 28 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,559] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 28 for partition [twitterstream,0] since its associated leader epoch 24 is not higher than the current leader epoch 24 (state.change.logger)
[2017-01-22 14:23:40,560] TRACE Controller 0 epoch 28 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:23:40,560] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:24,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 2 (state.change.logger)
[2017-01-22 14:23:40,561] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:23:40,562] TRACE Controller 0 epoch 28 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,562] TRACE Controller 0 epoch 28 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:23:40,562] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,562] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:23:40,563] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=28, leader=0, leaderEpoch=25, isr=[0], zkVersion=25, replicas=[0]) correlation id 3 from controller 0 epoch 28 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,563] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 28 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,563] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 28 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:23:40,563] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 28 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:23:40,564] TRACE Controller 0 epoch 28 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:23:40,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2017-01-22 14:23:40,564] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:24:40,394] TRACE Controller 0 epoch 29 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:40,396] ERROR Controller 0 epoch 29 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:24:42,491] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:24:42,491] TRACE Controller 0 epoch 29 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:24:42,491] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,491] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:24:42,492] TRACE Controller 0 epoch 29 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,492] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 0 (state.change.logger)
[2017-01-22 14:24:42,493] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:24:42,493] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=28, leader=0, leaderEpoch=25, isr=[0], zkVersion=25, replicas=[0]) correlation id 1 from controller 0 epoch 29 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,493] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 29 for partition [twitterstream,0] since its associated leader epoch 25 is not higher than the current leader epoch 25 (state.change.logger)
[2017-01-22 14:24:42,494] TRACE Controller 0 epoch 29 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:24:42,494] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 2 (state.change.logger)
[2017-01-22 14:24:42,494] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:24:42,495] TRACE Controller 0 epoch 29 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,495] TRACE Controller 0 epoch 29 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:24:42,495] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,495] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:24:42,496] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=29, leader=0, leaderEpoch=26, isr=[0], zkVersion=26, replicas=[0]) correlation id 3 from controller 0 epoch 29 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,496] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 29 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,496] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 29 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:24:42,496] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 29 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:24:42,496] TRACE Controller 0 epoch 29 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:24:42,497] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 4 (state.change.logger)
[2017-01-22 14:24:42,497] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:25:43,607] TRACE Controller 0 epoch 30 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:43,610] ERROR Controller 0 epoch 30 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:25:45,772] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:25:45,773] TRACE Controller 0 epoch 30 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:25:45,773] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,773] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:25:45,774] TRACE Controller 0 epoch 30 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,774] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 0 (state.change.logger)
[2017-01-22 14:25:45,775] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:25:45,775] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=29, leader=0, leaderEpoch=26, isr=[0], zkVersion=26, replicas=[0]) correlation id 1 from controller 0 epoch 30 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,775] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 30 for partition [twitterstream,0] since its associated leader epoch 26 is not higher than the current leader epoch 26 (state.change.logger)
[2017-01-22 14:25:45,776] TRACE Controller 0 epoch 30 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:25:45,776] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 2 (state.change.logger)
[2017-01-22 14:25:45,777] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:25:45,778] TRACE Controller 0 epoch 30 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,779] TRACE Controller 0 epoch 30 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:25:45,779] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,779] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:25:45,779] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=30, leader=0, leaderEpoch=27, isr=[0], zkVersion=27, replicas=[0]) correlation id 3 from controller 0 epoch 30 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,780] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 30 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,780] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 30 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:25:45,780] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 30 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:25:45,781] TRACE Controller 0 epoch 30 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:25:45,781] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 4 (state.change.logger)
[2017-01-22 14:25:45,782] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:26:45,523] TRACE Controller 0 epoch 31 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:45,526] ERROR Controller 0 epoch 31 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:26:47,360] TRACE Controller 0 epoch 31 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:26:47,361] TRACE Controller 0 epoch 31 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:26:47,361] TRACE Controller 0 epoch 31 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,361] TRACE Controller 0 epoch 31 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:26:47,361] TRACE Controller 0 epoch 31 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,364] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 0 (state.change.logger)
[2017-01-22 14:26:47,364] TRACE Controller 0 epoch 31 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:26:47,365] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=30, leader=0, leaderEpoch=27, isr=[0], zkVersion=27, replicas=[0]) correlation id 1 from controller 0 epoch 31 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,365] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 31 for partition [twitterstream,0] since its associated leader epoch 27 is not higher than the current leader epoch 27 (state.change.logger)
[2017-01-22 14:26:47,365] TRACE Controller 0 epoch 31 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:26:47,365] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 2 (state.change.logger)
[2017-01-22 14:26:47,366] TRACE Controller 0 epoch 31 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:26:47,366] TRACE Controller 0 epoch 31 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,366] TRACE Controller 0 epoch 31 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:26:47,366] TRACE Controller 0 epoch 31 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,366] TRACE Controller 0 epoch 31 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:26:47,367] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=31, leader=0, leaderEpoch=28, isr=[0], zkVersion=28, replicas=[0]) correlation id 3 from controller 0 epoch 31 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,367] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 31 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,367] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 31 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:26:47,367] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 31 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:26:47,368] TRACE Controller 0 epoch 31 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:26:47,368] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 4 (state.change.logger)
[2017-01-22 14:26:47,369] TRACE Controller 0 epoch 31 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:27:50,376] TRACE Controller 0 epoch 32 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:50,379] ERROR Controller 0 epoch 32 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:27:51,682] TRACE Controller 0 epoch 32 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:27:51,683] TRACE Controller 0 epoch 32 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:27:51,683] TRACE Controller 0 epoch 32 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,683] TRACE Controller 0 epoch 32 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:27:51,683] TRACE Controller 0 epoch 32 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,684] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 32 with correlation id 0 (state.change.logger)
[2017-01-22 14:27:51,684] TRACE Controller 0 epoch 32 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:27:51,685] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=31, leader=0, leaderEpoch=28, isr=[0], zkVersion=28, replicas=[0]) correlation id 1 from controller 0 epoch 32 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,685] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 32 for partition [twitterstream,0] since its associated leader epoch 28 is not higher than the current leader epoch 28 (state.change.logger)
[2017-01-22 14:27:51,685] TRACE Controller 0 epoch 32 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:27:51,686] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:31),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 32 with correlation id 2 (state.change.logger)
[2017-01-22 14:27:51,686] TRACE Controller 0 epoch 32 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,686] TRACE Controller 0 epoch 32 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:27:51,686] TRACE Controller 0 epoch 32 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:27:51,686] TRACE Controller 0 epoch 32 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,687] TRACE Controller 0 epoch 32 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:27:51,687] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=32, leader=0, leaderEpoch=29, isr=[0], zkVersion=29, replicas=[0]) correlation id 3 from controller 0 epoch 32 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,687] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 32 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,687] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 32 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:27:51,687] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 32 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:27:51,688] TRACE Controller 0 epoch 32 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:27:51,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 32 with correlation id 4 (state.change.logger)
[2017-01-22 14:27:51,688] TRACE Controller 0 epoch 32 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:28:53,066] TRACE Controller 0 epoch 33 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:53,069] ERROR Controller 0 epoch 33 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:28:54,306] TRACE Controller 0 epoch 33 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:28:54,306] TRACE Controller 0 epoch 33 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:28:54,306] TRACE Controller 0 epoch 33 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,306] TRACE Controller 0 epoch 33 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:28:54,306] TRACE Controller 0 epoch 33 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,307] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 0 (state.change.logger)
[2017-01-22 14:28:54,308] TRACE Controller 0 epoch 33 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:28:54,308] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=32, leader=0, leaderEpoch=29, isr=[0], zkVersion=29, replicas=[0]) correlation id 1 from controller 0 epoch 33 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,308] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 33 for partition [twitterstream,0] since its associated leader epoch 29 is not higher than the current leader epoch 29 (state.change.logger)
[2017-01-22 14:28:54,309] TRACE Controller 0 epoch 33 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:28:54,309] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:32),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 2 (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Controller 0 epoch 33 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Controller 0 epoch 33 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Controller 0 epoch 33 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Controller 0 epoch 33 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Controller 0 epoch 33 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:28:54,310] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=33, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 3 from controller 0 epoch 33 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,311] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 33 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,311] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 33 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:28:54,311] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 33 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:28:54,311] TRACE Controller 0 epoch 33 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:28:54,312] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 4 (state.change.logger)
[2017-01-22 14:28:54,313] TRACE Controller 0 epoch 33 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:29:55,620] TRACE Controller 0 epoch 34 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:55,623] ERROR Controller 0 epoch 34 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:29:57,691] TRACE Controller 0 epoch 34 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:29:57,692] TRACE Controller 0 epoch 34 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:29:57,692] TRACE Controller 0 epoch 34 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,692] TRACE Controller 0 epoch 34 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:29:57,693] TRACE Controller 0 epoch 34 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,693] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 34 with correlation id 0 (state.change.logger)
[2017-01-22 14:29:57,694] TRACE Controller 0 epoch 34 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:29:57,694] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=33, leader=0, leaderEpoch=30, isr=[0], zkVersion=30, replicas=[0]) correlation id 1 from controller 0 epoch 34 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,695] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 34 for partition [twitterstream,0] since its associated leader epoch 30 is not higher than the current leader epoch 30 (state.change.logger)
[2017-01-22 14:29:57,695] TRACE Controller 0 epoch 34 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:29:57,696] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:33),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 34 with correlation id 2 (state.change.logger)
[2017-01-22 14:29:57,696] TRACE Controller 0 epoch 34 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:29:57,697] TRACE Controller 0 epoch 34 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,697] TRACE Controller 0 epoch 34 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:29:57,697] TRACE Controller 0 epoch 34 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,697] TRACE Controller 0 epoch 34 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:29:57,698] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 3 from controller 0 epoch 34 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,698] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 34 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,698] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 34 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:29:57,698] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 34 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:29:57,699] TRACE Controller 0 epoch 34 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:29:57,699] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 34 with correlation id 4 (state.change.logger)
[2017-01-22 14:29:57,699] TRACE Controller 0 epoch 34 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:30:57,796] TRACE Controller 0 epoch 35 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:57,799] ERROR Controller 0 epoch 35 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:30:59,645] TRACE Controller 0 epoch 35 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:30:59,645] TRACE Controller 0 epoch 35 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:30:59,646] TRACE Controller 0 epoch 35 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,646] TRACE Controller 0 epoch 35 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:30:59,646] TRACE Controller 0 epoch 35 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,647] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 35 with correlation id 0 (state.change.logger)
[2017-01-22 14:30:59,647] TRACE Controller 0 epoch 35 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:30:59,648] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=34, leader=0, leaderEpoch=31, isr=[0], zkVersion=31, replicas=[0]) correlation id 1 from controller 0 epoch 35 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,648] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 35 for partition [twitterstream,0] since its associated leader epoch 31 is not higher than the current leader epoch 31 (state.change.logger)
[2017-01-22 14:30:59,648] TRACE Controller 0 epoch 35 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:30:59,648] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:34),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 35 with correlation id 2 (state.change.logger)
[2017-01-22 14:30:59,649] TRACE Controller 0 epoch 35 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:30:59,649] TRACE Controller 0 epoch 35 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,649] TRACE Controller 0 epoch 35 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:30:59,650] TRACE Controller 0 epoch 35 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,650] TRACE Controller 0 epoch 35 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:30:59,650] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=35, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 3 from controller 0 epoch 35 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,650] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 35 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,650] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 35 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:30:59,650] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 35 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:30:59,651] TRACE Controller 0 epoch 35 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:30:59,651] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 35 with correlation id 4 (state.change.logger)
[2017-01-22 14:30:59,652] TRACE Controller 0 epoch 35 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:33:02,798] TRACE Controller 0 epoch 36 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:02,802] ERROR Controller 0 epoch 36 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:33:04,725] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:33:04,725] TRACE Controller 0 epoch 36 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:33:04,725] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,725] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:33:04,725] TRACE Controller 0 epoch 36 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,726] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 0 (state.change.logger)
[2017-01-22 14:33:04,727] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:33:04,727] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=35, leader=0, leaderEpoch=32, isr=[0], zkVersion=32, replicas=[0]) correlation id 1 from controller 0 epoch 36 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,727] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 36 for partition [twitterstream,0] since its associated leader epoch 32 is not higher than the current leader epoch 32 (state.change.logger)
[2017-01-22 14:33:04,728] TRACE Controller 0 epoch 36 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:33:04,728] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:35),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2017-01-22 14:33:04,728] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:33:04,728] TRACE Controller 0 epoch 36 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Controller 0 epoch 36 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Controller 0 epoch 36 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Controller 0 epoch 36 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 3 from controller 0 epoch 36 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 36 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,729] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 36 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:33:04,729] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 36 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:33:04,730] TRACE Controller 0 epoch 36 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:33:04,730] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2017-01-22 14:33:04,730] TRACE Controller 0 epoch 36 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:34:05,590] TRACE Controller 0 epoch 37 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:05,598] ERROR Controller 0 epoch 37 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:34:07,674] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:34:07,675] TRACE Controller 0 epoch 37 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:34:07,675] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,675] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:34:07,675] TRACE Controller 0 epoch 37 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,676] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 0 (state.change.logger)
[2017-01-22 14:34:07,676] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:34:07,677] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=36, leader=0, leaderEpoch=33, isr=[0], zkVersion=33, replicas=[0]) correlation id 1 from controller 0 epoch 37 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,677] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 37 for partition [twitterstream,0] since its associated leader epoch 33 is not higher than the current leader epoch 33 (state.change.logger)
[2017-01-22 14:34:07,677] TRACE Controller 0 epoch 37 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:34:07,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:36),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 2 (state.change.logger)
[2017-01-22 14:34:07,678] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:34:07,679] TRACE Controller 0 epoch 37 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,679] TRACE Controller 0 epoch 37 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:34:07,679] TRACE Controller 0 epoch 37 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,679] TRACE Controller 0 epoch 37 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:34:07,679] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 3 from controller 0 epoch 37 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,680] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 37 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,680] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 37 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:34:07,680] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 37 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:34:07,680] TRACE Controller 0 epoch 37 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:34:07,681] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 37 with correlation id 4 (state.change.logger)
[2017-01-22 14:34:07,681] TRACE Controller 0 epoch 37 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:35:07,385] TRACE Controller 0 epoch 38 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:07,388] ERROR Controller 0 epoch 38 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:35:09,627] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:35:09,627] TRACE Controller 0 epoch 38 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:35:09,627] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,627] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:35:09,627] TRACE Controller 0 epoch 38 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 0 (state.change.logger)
[2017-01-22 14:35:09,629] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:35:09,629] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=37, leader=0, leaderEpoch=34, isr=[0], zkVersion=34, replicas=[0]) correlation id 1 from controller 0 epoch 38 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,629] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 38 for partition [twitterstream,0] since its associated leader epoch 34 is not higher than the current leader epoch 34 (state.change.logger)
[2017-01-22 14:35:09,629] TRACE Controller 0 epoch 38 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:35:09,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 2 (state.change.logger)
[2017-01-22 14:35:09,630] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:35:09,630] TRACE Controller 0 epoch 38 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,631] TRACE Controller 0 epoch 38 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:35:09,631] TRACE Controller 0 epoch 38 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,631] TRACE Controller 0 epoch 38 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:35:09,631] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=35, isr=[0], zkVersion=35, replicas=[0]) correlation id 3 from controller 0 epoch 38 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,631] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 38 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,631] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 38 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:35:09,632] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 38 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:35:09,632] TRACE Controller 0 epoch 38 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:35:09,632] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 38 with correlation id 4 (state.change.logger)
[2017-01-22 14:35:09,633] TRACE Controller 0 epoch 38 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:36:10,134] TRACE Controller 0 epoch 39 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:10,137] ERROR Controller 0 epoch 39 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:36:11,508] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:36:11,508] TRACE Controller 0 epoch 39 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:36:11,508] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,509] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:36:11,509] TRACE Controller 0 epoch 39 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,510] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 0 (state.change.logger)
[2017-01-22 14:36:11,510] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:36:11,511] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=38, leader=0, leaderEpoch=35, isr=[0], zkVersion=35, replicas=[0]) correlation id 1 from controller 0 epoch 39 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,511] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 39 for partition [twitterstream,0] since its associated leader epoch 35 is not higher than the current leader epoch 35 (state.change.logger)
[2017-01-22 14:36:11,511] TRACE Controller 0 epoch 39 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:36:11,512] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 2 (state.change.logger)
[2017-01-22 14:36:11,512] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:36:11,513] TRACE Controller 0 epoch 39 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,513] TRACE Controller 0 epoch 39 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:36:11,513] TRACE Controller 0 epoch 39 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,513] TRACE Controller 0 epoch 39 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:36:11,513] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=36, isr=[0], zkVersion=36, replicas=[0]) correlation id 3 from controller 0 epoch 39 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,514] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 39 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,514] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 39 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:36:11,514] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 39 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:36:11,514] TRACE Controller 0 epoch 39 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:36:11,515] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 39 with correlation id 4 (state.change.logger)
[2017-01-22 14:36:11,515] TRACE Controller 0 epoch 39 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:38:15,045] TRACE Controller 0 epoch 40 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:15,048] ERROR Controller 0 epoch 40 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:38:16,391] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:38:16,392] TRACE Controller 0 epoch 40 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:38:16,392] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,392] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:38:16,392] TRACE Controller 0 epoch 40 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,393] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 0 (state.change.logger)
[2017-01-22 14:38:16,393] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:38:16,394] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=39, leader=0, leaderEpoch=36, isr=[0], zkVersion=36, replicas=[0]) correlation id 1 from controller 0 epoch 40 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,394] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 40 for partition [twitterstream,0] since its associated leader epoch 36 is not higher than the current leader epoch 36 (state.change.logger)
[2017-01-22 14:38:16,394] TRACE Controller 0 epoch 40 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:38:16,395] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:39),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 2 (state.change.logger)
[2017-01-22 14:38:16,395] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:38:16,397] TRACE Controller 0 epoch 40 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,397] TRACE Controller 0 epoch 40 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:38:16,397] TRACE Controller 0 epoch 40 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,397] TRACE Controller 0 epoch 40 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:38:16,398] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=37, isr=[0], zkVersion=37, replicas=[0]) correlation id 3 from controller 0 epoch 40 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,398] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 40 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,398] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 40 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:38:16,398] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 40 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:38:16,399] TRACE Controller 0 epoch 40 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:38:16,399] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 40 with correlation id 4 (state.change.logger)
[2017-01-22 14:38:16,399] TRACE Controller 0 epoch 40 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:39:16,827] TRACE Controller 0 epoch 41 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:16,830] ERROR Controller 0 epoch 41 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:39:18,623] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:39:18,623] TRACE Controller 0 epoch 41 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:39:18,623] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,623] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:39:18,623] TRACE Controller 0 epoch 41 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 0 (state.change.logger)
[2017-01-22 14:39:18,625] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:39:18,625] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=40, leader=0, leaderEpoch=37, isr=[0], zkVersion=37, replicas=[0]) correlation id 1 from controller 0 epoch 41 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,625] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 41 for partition [twitterstream,0] since its associated leader epoch 37 is not higher than the current leader epoch 37 (state.change.logger)
[2017-01-22 14:39:18,626] TRACE Controller 0 epoch 41 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:39:18,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:40),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 2 (state.change.logger)
[2017-01-22 14:39:18,627] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:39:18,627] TRACE Controller 0 epoch 41 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,627] TRACE Controller 0 epoch 41 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:39:18,627] TRACE Controller 0 epoch 41 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,628] TRACE Controller 0 epoch 41 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:39:18,628] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=38, isr=[0], zkVersion=38, replicas=[0]) correlation id 3 from controller 0 epoch 41 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,628] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 41 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,628] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 41 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:39:18,628] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 41 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:39:18,629] TRACE Controller 0 epoch 41 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:39:18,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 41 with correlation id 4 (state.change.logger)
[2017-01-22 14:39:18,629] TRACE Controller 0 epoch 41 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:40:18,683] TRACE Controller 0 epoch 42 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:18,686] ERROR Controller 0 epoch 42 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:40:20,289] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:40:20,289] TRACE Controller 0 epoch 42 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:40:20,290] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,290] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:40:20,290] TRACE Controller 0 epoch 42 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,298] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 0 (state.change.logger)
[2017-01-22 14:40:20,298] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:40:20,298] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=41, leader=0, leaderEpoch=38, isr=[0], zkVersion=38, replicas=[0]) correlation id 1 from controller 0 epoch 42 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,298] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 42 for partition [twitterstream,0] since its associated leader epoch 38 is not higher than the current leader epoch 38 (state.change.logger)
[2017-01-22 14:40:20,299] TRACE Controller 0 epoch 42 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:40:20,299] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:41),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 2 (state.change.logger)
[2017-01-22 14:40:20,299] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Controller 0 epoch 42 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Controller 0 epoch 42 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Controller 0 epoch 42 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Controller 0 epoch 42 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=39, isr=[0], zkVersion=39, replicas=[0]) correlation id 3 from controller 0 epoch 42 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,300] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 42 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,300] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 42 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:40:20,301] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 42 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:40:20,301] TRACE Controller 0 epoch 42 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:40:20,301] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 42 with correlation id 4 (state.change.logger)
[2017-01-22 14:40:20,302] TRACE Controller 0 epoch 42 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:43:26,398] TRACE Controller 0 epoch 43 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:26,402] ERROR Controller 0 epoch 43 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:43:28,537] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:43:28,538] TRACE Controller 0 epoch 43 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:43:28,538] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,538] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:43:28,538] TRACE Controller 0 epoch 43 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,539] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 0 (state.change.logger)
[2017-01-22 14:43:28,539] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:43:28,539] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=42, leader=0, leaderEpoch=39, isr=[0], zkVersion=39, replicas=[0]) correlation id 1 from controller 0 epoch 43 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,540] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 43 for partition [twitterstream,0] since its associated leader epoch 39 is not higher than the current leader epoch 39 (state.change.logger)
[2017-01-22 14:43:28,540] TRACE Controller 0 epoch 43 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:43:28,540] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:39,ControllerEpoch:42),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 2 (state.change.logger)
[2017-01-22 14:43:28,541] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:43:28,541] TRACE Controller 0 epoch 43 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,541] TRACE Controller 0 epoch 43 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:43:28,541] TRACE Controller 0 epoch 43 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,542] TRACE Controller 0 epoch 43 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:43:28,542] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=40, isr=[0], zkVersion=40, replicas=[0]) correlation id 3 from controller 0 epoch 43 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,542] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 43 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,542] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 43 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:43:28,543] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 43 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:43:28,543] TRACE Controller 0 epoch 43 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:43:28,543] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 43 with correlation id 4 (state.change.logger)
[2017-01-22 14:43:28,544] TRACE Controller 0 epoch 43 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:44:28,722] TRACE Controller 0 epoch 44 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:28,725] ERROR Controller 0 epoch 44 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:44:30,595] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:44:30,595] TRACE Controller 0 epoch 44 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:44:30,595] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,595] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:44:30,596] TRACE Controller 0 epoch 44 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,596] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 0 (state.change.logger)
[2017-01-22 14:44:30,596] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:44:30,597] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=43, leader=0, leaderEpoch=40, isr=[0], zkVersion=40, replicas=[0]) correlation id 1 from controller 0 epoch 44 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,597] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 44 for partition [twitterstream,0] since its associated leader epoch 40 is not higher than the current leader epoch 40 (state.change.logger)
[2017-01-22 14:44:30,597] TRACE Controller 0 epoch 44 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:44:30,598] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:40,ControllerEpoch:43),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 2 (state.change.logger)
[2017-01-22 14:44:30,598] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:44:30,600] TRACE Controller 0 epoch 44 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,600] TRACE Controller 0 epoch 44 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:44:30,600] TRACE Controller 0 epoch 44 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,600] TRACE Controller 0 epoch 44 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:44:30,601] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=41, isr=[0], zkVersion=41, replicas=[0]) correlation id 3 from controller 0 epoch 44 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,601] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 44 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,601] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 44 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:44:30,601] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 44 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:44:30,601] TRACE Controller 0 epoch 44 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:44:30,602] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 44 with correlation id 4 (state.change.logger)
[2017-01-22 14:44:30,602] TRACE Controller 0 epoch 44 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:45:31,869] TRACE Controller 0 epoch 45 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:31,874] ERROR Controller 0 epoch 45 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:45:33,510] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:45:33,511] TRACE Controller 0 epoch 45 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:45:33,511] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,511] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:45:33,512] TRACE Controller 0 epoch 45 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,513] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 0 (state.change.logger)
[2017-01-22 14:45:33,513] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:45:33,516] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=44, leader=0, leaderEpoch=41, isr=[0], zkVersion=41, replicas=[0]) correlation id 1 from controller 0 epoch 45 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,517] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 45 for partition [twitterstream,0] since its associated leader epoch 41 is not higher than the current leader epoch 41 (state.change.logger)
[2017-01-22 14:45:33,517] TRACE Controller 0 epoch 45 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:45:33,518] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:41,ControllerEpoch:44),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 2 (state.change.logger)
[2017-01-22 14:45:33,518] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:45:33,519] TRACE Controller 0 epoch 45 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,520] TRACE Controller 0 epoch 45 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:45:33,520] TRACE Controller 0 epoch 45 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,520] TRACE Controller 0 epoch 45 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:45:33,521] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=42, isr=[0], zkVersion=42, replicas=[0]) correlation id 3 from controller 0 epoch 45 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,521] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 45 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,521] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 45 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:45:33,521] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 45 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:45:33,522] TRACE Controller 0 epoch 45 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:45:33,523] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 45 with correlation id 4 (state.change.logger)
[2017-01-22 14:45:33,523] TRACE Controller 0 epoch 45 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:46:33,690] TRACE Controller 0 epoch 46 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:33,695] ERROR Controller 0 epoch 46 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:46:35,225] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Controller 0 epoch 46 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Controller 0 epoch 46 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 0 (state.change.logger)
[2017-01-22 14:46:35,226] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:46:35,227] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=45, leader=0, leaderEpoch=42, isr=[0], zkVersion=42, replicas=[0]) correlation id 1 from controller 0 epoch 46 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,227] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 46 for partition [twitterstream,0] since its associated leader epoch 42 is not higher than the current leader epoch 42 (state.change.logger)
[2017-01-22 14:46:35,227] TRACE Controller 0 epoch 46 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:46:35,228] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:42,ControllerEpoch:45),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 2 (state.change.logger)
[2017-01-22 14:46:35,228] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:46:35,229] TRACE Controller 0 epoch 46 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,230] TRACE Controller 0 epoch 46 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:46:35,230] TRACE Controller 0 epoch 46 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,230] TRACE Controller 0 epoch 46 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:46:35,230] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=43, isr=[0], zkVersion=43, replicas=[0]) correlation id 3 from controller 0 epoch 46 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,230] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 46 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,231] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 46 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:46:35,231] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 46 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:46:35,231] TRACE Controller 0 epoch 46 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:46:35,232] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 46 with correlation id 4 (state.change.logger)
[2017-01-22 14:46:35,232] TRACE Controller 0 epoch 46 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:49:42,240] TRACE Controller 0 epoch 47 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:42,243] ERROR Controller 0 epoch 47 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:49:43,787] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:49:43,787] TRACE Controller 0 epoch 47 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:49:43,787] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,787] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:49:43,788] TRACE Controller 0 epoch 47 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,788] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 0 (state.change.logger)
[2017-01-22 14:49:43,788] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:49:43,789] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=46, leader=0, leaderEpoch=43, isr=[0], zkVersion=43, replicas=[0]) correlation id 1 from controller 0 epoch 47 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,789] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 47 for partition [twitterstream,0] since its associated leader epoch 43 is not higher than the current leader epoch 43 (state.change.logger)
[2017-01-22 14:49:43,789] TRACE Controller 0 epoch 47 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:49:43,790] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:43,ControllerEpoch:46),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 2 (state.change.logger)
[2017-01-22 14:49:43,790] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:49:43,791] TRACE Controller 0 epoch 47 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,791] TRACE Controller 0 epoch 47 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:49:43,791] TRACE Controller 0 epoch 47 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,791] TRACE Controller 0 epoch 47 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:49:43,792] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=44, isr=[0], zkVersion=44, replicas=[0]) correlation id 3 from controller 0 epoch 47 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,792] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 47 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,792] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 47 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:49:43,792] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 47 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:49:43,793] TRACE Controller 0 epoch 47 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:49:43,794] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 47 with correlation id 4 (state.change.logger)
[2017-01-22 14:49:43,794] TRACE Controller 0 epoch 47 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:50:44,183] TRACE Controller 0 epoch 48 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:44,189] ERROR Controller 0 epoch 48 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:50:46,698] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:50:46,699] TRACE Controller 0 epoch 48 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:50:46,699] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,699] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:50:46,699] TRACE Controller 0 epoch 48 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,700] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 0 (state.change.logger)
[2017-01-22 14:50:46,700] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:50:46,700] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=47, leader=0, leaderEpoch=44, isr=[0], zkVersion=44, replicas=[0]) correlation id 1 from controller 0 epoch 48 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,700] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 48 for partition [twitterstream,0] since its associated leader epoch 44 is not higher than the current leader epoch 44 (state.change.logger)
[2017-01-22 14:50:46,701] TRACE Controller 0 epoch 48 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:50:46,701] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:44,ControllerEpoch:47),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 2 (state.change.logger)
[2017-01-22 14:50:46,701] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Controller 0 epoch 48 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Controller 0 epoch 48 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Controller 0 epoch 48 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Controller 0 epoch 48 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=45, isr=[0], zkVersion=45, replicas=[0]) correlation id 3 from controller 0 epoch 48 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,703] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 48 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,704] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 48 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:50:46,704] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 48 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:50:46,704] TRACE Controller 0 epoch 48 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:50:46,705] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 48 with correlation id 4 (state.change.logger)
[2017-01-22 14:50:46,705] TRACE Controller 0 epoch 48 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:51:45,659] TRACE Controller 0 epoch 49 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:45,663] ERROR Controller 0 epoch 49 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:51:47,717] TRACE Controller 0 epoch 49 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:51:47,718] TRACE Controller 0 epoch 49 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:51:47,718] TRACE Controller 0 epoch 49 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,718] TRACE Controller 0 epoch 49 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:51:47,718] TRACE Controller 0 epoch 49 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,719] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 49 with correlation id 0 (state.change.logger)
[2017-01-22 14:51:47,719] TRACE Controller 0 epoch 49 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:51:47,719] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=48, leader=0, leaderEpoch=45, isr=[0], zkVersion=45, replicas=[0]) correlation id 1 from controller 0 epoch 49 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,719] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 49 for partition [twitterstream,0] since its associated leader epoch 45 is not higher than the current leader epoch 45 (state.change.logger)
[2017-01-22 14:51:47,720] TRACE Controller 0 epoch 49 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:51:47,720] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:45,ControllerEpoch:48),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 49 with correlation id 2 (state.change.logger)
[2017-01-22 14:51:47,720] TRACE Controller 0 epoch 49 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:51:47,721] TRACE Controller 0 epoch 49 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,721] TRACE Controller 0 epoch 49 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:51:47,721] TRACE Controller 0 epoch 49 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,721] TRACE Controller 0 epoch 49 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:51:47,722] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=49, leader=0, leaderEpoch=46, isr=[0], zkVersion=46, replicas=[0]) correlation id 3 from controller 0 epoch 49 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,722] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 49 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,722] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 49 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:51:47,722] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 49 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:51:47,722] TRACE Controller 0 epoch 49 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:51:47,723] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 49 with correlation id 4 (state.change.logger)
[2017-01-22 14:51:47,723] TRACE Controller 0 epoch 49 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:54:53,481] TRACE Controller 0 epoch 50 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:53,484] ERROR Controller 0 epoch 50 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:54:55,733] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:54:55,733] TRACE Controller 0 epoch 50 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:54:55,733] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,733] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:54:55,734] TRACE Controller 0 epoch 50 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,734] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 0 (state.change.logger)
[2017-01-22 14:54:55,734] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:54:55,735] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=49, leader=0, leaderEpoch=46, isr=[0], zkVersion=46, replicas=[0]) correlation id 1 from controller 0 epoch 50 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,735] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 50 for partition [twitterstream,0] since its associated leader epoch 46 is not higher than the current leader epoch 46 (state.change.logger)
[2017-01-22 14:54:55,735] TRACE Controller 0 epoch 50 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:54:55,736] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:46,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 2 (state.change.logger)
[2017-01-22 14:54:55,736] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:54:55,737] TRACE Controller 0 epoch 50 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,737] TRACE Controller 0 epoch 50 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:54:55,737] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,738] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:54:55,738] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=50, leader=0, leaderEpoch=47, isr=[0], zkVersion=47, replicas=[0]) correlation id 3 from controller 0 epoch 50 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,738] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 50 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,738] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 50 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:54:55,738] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 50 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:54:55,739] TRACE Controller 0 epoch 50 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:54:55,739] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 4 (state.change.logger)
[2017-01-22 14:54:55,740] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:55:55,358] TRACE Controller 0 epoch 51 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:55,362] ERROR Controller 0 epoch 51 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:55:57,323] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:55:57,324] TRACE Controller 0 epoch 51 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:55:57,324] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,324] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:55:57,324] TRACE Controller 0 epoch 51 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,325] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 0 (state.change.logger)
[2017-01-22 14:55:57,325] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:55:57,326] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=50, leader=0, leaderEpoch=47, isr=[0], zkVersion=47, replicas=[0]) correlation id 1 from controller 0 epoch 51 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,326] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 51 for partition [twitterstream,0] since its associated leader epoch 47 is not higher than the current leader epoch 47 (state.change.logger)
[2017-01-22 14:55:57,326] TRACE Controller 0 epoch 51 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:55:57,327] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:47,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 2 (state.change.logger)
[2017-01-22 14:55:57,328] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:55:57,328] TRACE Controller 0 epoch 51 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,329] TRACE Controller 0 epoch 51 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:55:57,329] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,329] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:55:57,329] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=51, leader=0, leaderEpoch=48, isr=[0], zkVersion=48, replicas=[0]) correlation id 3 from controller 0 epoch 51 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,329] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 51 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,330] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 51 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:55:57,330] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 51 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:55:57,330] TRACE Controller 0 epoch 51 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:55:57,331] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 4 (state.change.logger)
[2017-01-22 14:55:57,331] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:56:58,623] TRACE Controller 0 epoch 52 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:56:58,627] ERROR Controller 0 epoch 52 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:57:00,624] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:57:00,625] TRACE Controller 0 epoch 52 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:57:00,625] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,625] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:57:00,625] TRACE Controller 0 epoch 52 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,626] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 0 (state.change.logger)
[2017-01-22 14:57:00,626] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:57:00,626] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=51, leader=0, leaderEpoch=48, isr=[0], zkVersion=48, replicas=[0]) correlation id 1 from controller 0 epoch 52 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,627] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 52 for partition [twitterstream,0] since its associated leader epoch 48 is not higher than the current leader epoch 48 (state.change.logger)
[2017-01-22 14:57:00,627] TRACE Controller 0 epoch 52 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:57:00,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 2 (state.change.logger)
[2017-01-22 14:57:00,628] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:57:00,628] TRACE Controller 0 epoch 52 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,629] TRACE Controller 0 epoch 52 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:57:00,629] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,629] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:57:00,629] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=52, leader=0, leaderEpoch=49, isr=[0], zkVersion=49, replicas=[0]) correlation id 3 from controller 0 epoch 52 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,629] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 52 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,630] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 52 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:57:00,630] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 52 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:57:00,630] TRACE Controller 0 epoch 52 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:57:00,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 4 (state.change.logger)
[2017-01-22 14:57:00,631] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:58:01,418] TRACE Controller 0 epoch 53 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:01,422] ERROR Controller 0 epoch 53 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:58:03,624] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:58:03,624] TRACE Controller 0 epoch 53 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:58:03,624] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,625] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:58:03,625] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 0 (state.change.logger)
[2017-01-22 14:58:03,625] TRACE Controller 0 epoch 53 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,625] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:58:03,626] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=52, leader=0, leaderEpoch=49, isr=[0], zkVersion=49, replicas=[0]) correlation id 1 from controller 0 epoch 53 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,626] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 53 for partition [twitterstream,0] since its associated leader epoch 49 is not higher than the current leader epoch 49 (state.change.logger)
[2017-01-22 14:58:03,626] TRACE Controller 0 epoch 53 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:58:03,627] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 2 (state.change.logger)
[2017-01-22 14:58:03,628] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:58:03,628] TRACE Controller 0 epoch 53 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,629] TRACE Controller 0 epoch 53 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:58:03,629] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,629] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:58:03,629] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=53, leader=0, leaderEpoch=50, isr=[0], zkVersion=50, replicas=[0]) correlation id 3 from controller 0 epoch 53 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,629] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 53 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,630] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 53 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:58:03,630] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 53 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:58:03,630] TRACE Controller 0 epoch 53 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:58:03,631] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 4 (state.change.logger)
[2017-01-22 14:58:03,631] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:59:03,695] TRACE Controller 0 epoch 54 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:03,697] ERROR Controller 0 epoch 54 initiated state change for partition [twitterstream,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [twitterstream,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:336)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:167)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1168)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1166)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1166)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-01-22 14:59:05,540] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:59:05,540] TRACE Controller 0 epoch 54 changed state of replica 0 for partition [twitterstream,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-01-22 14:59:05,540] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,540] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:59:05,540] TRACE Controller 0 epoch 54 started leader election for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,541] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 0 (state.change.logger)
[2017-01-22 14:59:05,541] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:59:05,541] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=53, leader=0, leaderEpoch=50, isr=[0], zkVersion=50, replicas=[0]) correlation id 1 from controller 0 epoch 54 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,541] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 54 for partition [twitterstream,0] since its associated leader epoch 50 is not higher than the current leader epoch 50 (state.change.logger)
[2017-01-22 14:59:05,542] TRACE Controller 0 epoch 54 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:59:05,542] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 2 (state.change.logger)
[2017-01-22 14:59:05,542] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:59:05,543] TRACE Controller 0 epoch 54 elected leader 0 for Offline partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,543] TRACE Controller 0 epoch 54 changed partition [twitterstream,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-01-22 14:59:05,543] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:54) to broker 0 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,543] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:54) to broker 0 for partition twitterstream-0 (state.change.logger)
[2017-01-22 14:59:05,544] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=54, leader=0, leaderEpoch=51, isr=[0], zkVersion=51, replicas=[0]) correlation id 3 from controller 0 epoch 54 for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,544] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 54 starting the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,544] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 54 for partition [twitterstream,0] since it is already the leader for the partition. (state.change.logger)
[2017-01-22 14:59:05,544] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 54 for the become-leader transition for partition [twitterstream,0] (state.change.logger)
[2017-01-22 14:59:05,544] TRACE Controller 0 epoch 54 received response {error_code=0,partitions=[{topic=twitterstream,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-01-22 14:59:05,545] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition twitterstream-0 in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 4 (state.change.logger)
[2017-01-22 14:59:05,545] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
